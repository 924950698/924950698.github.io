(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{340:function(s,e,r){"use strict";r.r(e);var n=r(10),a=Object(n.a)({},(function(){var s=this,e=s._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"angular-依赖注入-4-1"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#angular-依赖注入-4-1"}},[s._v("#")]),s._v(" Angular 依赖注入 （4-1）")]),s._v(" "),e("h3",[s._v("1. 什么是依赖性注入？ ")]),s._v(" "),e("p",[s._v("是一种设计模式，依赖性注入框架")]),s._v(" "),e("p",[e("b",[s._v("Angular提供的依赖注入框架 ")])]),s._v(" "),e("ul",[e("li",[s._v("依赖注入：先有依赖，后有注入")]),s._v(" "),e("li",[s._v("把依赖写在contructor里，同时在providers里做配置。")]),s._v(" "),e("li",[s._v("依赖写完后，angular会自动注入。")]),s._v(" "),e("li",[s._v("这时，保证组件必备有一个@Injectable修饰符")])]),s._v(" "),e("h3",[s._v("2. 依赖注入的两种方式： ")]),s._v(" "),e("p",[e("b",[s._v("起因：")]),s._v(" Products 组件里面放了product相关的各种信息，\n但是这些信息不是被这个组件独享的，\n我们想到这些组件是公共的，我们应该把它放到service里。")]),s._v(" "),e("p",[e("b",[s._v("1. 创建：")]),s._v("我们通过"),e("code",[s._v("Ng g service/product")]),s._v(" 命令创建了一个product服务。\n并把公用的数据类型和方法放在了其中。")]),s._v(" "),e("p",[e("b",[s._v("2. 依赖：(自己写依赖)（全局配置）")]),s._v(" 下面把这个服务提供给别的组件使用，在app.moduls里面做配置，写在providers里面。 "),e("code",[s._v("providers:[ ProductService ]")]),s._v(" 所有的组件都可以使用该服务了。")]),s._v(" "),e("p",[e("b",[s._v("3. 注入：（Angular负责注入）")]),s._v("在需要使用的组件的 constructor 中接收。\n"),e("code",[s._v("constructor(productService: productService) {}")])]),s._v(" "),e("p",[s._v("什么是依赖注入？组件在实例化的过程中，依赖外部的某个服务，Angular负责将该服务注入。")]),s._v(" "),e("p",[s._v("依赖需要手动声明，注入是Angular自动化的。")]),s._v(" "),e("p",[e("b",[s._v("4. 依赖注入的另一种方式：(局部配置)")]),s._v(" 在当前组件的"),e("code",[s._v("@Component({})")]),s._v(" 中注入 "),e("code",[s._v("providers:[ ProductService ]")])]),s._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[s._v("关于 局部注入（组件注入）的注意：")]),s._v(" "),e("ol",[e("li",[s._v("组件注入方式别的组件无法使用。")]),s._v(" "),e("li",[s._v("组件注入的优先级高于全局注入的优先级")])])]),s._v(" "),e("p",[e("b",[s._v(" 默认方式(useClass)： ")])]),s._v(" "),e("p",[s._v("此时，假如productService升级，app.module.ts中随之改变：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("providers: [\n    {\n        provide: ProductService,      // services的标识符\n        useClass: OtherProductService  //  provide的具体注入值， 注入名称依然是ProductService \n    }\n]\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("p",[e("b",[s._v(" 工程模式(useFactory): ")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("providers: [\n    {\n        provide: TestService,    \n        useFactory: factoryFunc  \n    }\n]\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("p",[e("b",[s._v(" 与useClass的区别：需要手动创建 factoryFunc 函数， 给到 useFactory ")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("\n// 传入的参数不同，返回的值不同。像一个工厂\nexport const factoryFunc = () => {  \n    return new TestService();\n}\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("p",[e("b",[s._v(" 参数订阅 和 参数快照 ")])]),s._v(" "),e("p",[s._v("一旦当前页面被执行，就可以从constructor中依赖注入的变量中取参数，两种方式。参数订阅 和 参数快照。")]),s._v(" "),e("b",[e("p",[s._v("订阅：时时更新")]),s._v(" "),e("p",[s._v("快照：某一时刻的照片，不会时时更新")])])])}),[],!1,null,null,null);e.default=a.exports}}]);